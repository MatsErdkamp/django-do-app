import{_ as D,r as u,o as v,a as s,c as n,t as f,F as w,b,d as i,p as $,e as S,n as k,f as C,g as m}from"./index-mP24_oqz.js";const x=c=>($("data-v-684cfe1b"),c=c(),S(),c),I=x(()=>i("h1",null,"Calendar Data",-1)),N={key:0},B={key:1,class:"error"},E={key:2},F={class:"calendar-item"},W={__name:"DashboardCalendar",setup(c){const h=u(null),a=u(!1),l=u(null),d={weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"};function t(e){return new Intl.DateTimeFormat("en-US",d).format(new Date(e))}async function o(){a.value=!0;try{const e=await fetch("http://127.0.0.1:8000/api/calendar/");if(!e.ok)throw new Error("Failed to fetch");const r=await e.json();h.value=r[0].google_response.items}catch(e){l.value=e.message}finally{a.value=!1}}return v(()=>{o()}),(e,r)=>(s(),n("div",null,[I,a.value?(s(),n("div",N,"Loading...")):l.value?(s(),n("div",B,f(l.value),1)):(s(),n("div",E,[(s(!0),n(w,null,b(h.value,_=>(s(),n("div",F,[i("h2",null,f(_.summary),1),i("div",null,f(t(_.start.dateTime)),1)]))),256))]))]))}},H=D(W,[["__scopeId","data-v-684cfe1b"]]),y=c=>($("data-v-27530213"),c=c(),S(),c),L=y(()=>i("h1",null,"Battery State",-1)),T={key:0},j={key:1,class:"error"},O={key:2},P={class:"calendar-item"},R=y(()=>i("div",null,"NOT CONNECTED",-1)),U={style:{"border-top":"1px solid #212121","margin-top":"8px","padding-top":"4px"}},V=y(()=>i("div",null,"For 80% charge",-1)),M={__name:"DashboardBattery",props:{charge:Number,hours:Number},setup(c){const h=u(null),a=u(!1),l=u(null),d=c;async function t(){a.value=!0;try{const o=await fetch("http://127.0.0.1:8000/api/calendar/");if(!o.ok)throw new Error("Failed to fetch");const e=await o.json();h.value=e[0].google_response.items}catch(o){l.value=o.message}finally{a.value=!1}}return v(()=>{t()}),(o,e)=>(s(),n("div",null,[L,a.value?(s(),n("div",T,"Loading...")):l.value?(s(),n("div",j,f(l.value),1)):(s(),n("div",O,[i("div",P,[i("h2",null,f(d.charge),1),R,i("h2",U,f(d.hours),1),V])]))]))}},z=D(M,[["__scopeId","data-v-27530213"]]),J=i("h1",null,"Charge Moments",-1),q={class:"charge-histogram"},A={class:"charge-histogram-charging-indicator"},G=["onClick"],K={__name:"DashboardHistogram",setup(c){const h=u(10),a=u(!0);function l(e,r){return e==r?"background:red;":e>r?"background: #212121;":"background: #green;"}const d=u([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);function t(e){h.value=e}async function o(){a.value=!0;try{const e=await fetch("http://127.0.0.1:8000/api/curve/");if(!e.ok)throw new Error("Failed to fetch");const r=await e.json();d.value=r}catch(e){error.value=e.message}finally{a.value=!1}}return v(()=>{o()}),(e,r)=>(s(),n("div",null,[J,i("div",q,[(s(!0),n(w,null,b(d.value,(_,p)=>(s(),n("div",{class:"price-bar",style:k({height:_+"%"})},null,4))),256))]),i("div",A,[(s(!0),n(w,null,b(d.value,(_,p)=>(s(),n("div",{class:"charge-bar",style:k(l(p,h.value)),onClick:g=>t(p)},null,12,G))),256))])]))}},Q={class:"dashboard-container"},Y={__name:"DashboardView",setup(c){function h(){var t=window.location.protocol==="https:"?"wss:":"ws:",o=window.location.host;(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")&&(o="localhost:8000");var e="/ws/car/",r=t+"//"+o+e;return new WebSocket(r)}let a=h();const l=u(0),d=u(0);return v(()=>{a.onopen=function(){console.log("WebSocket connected.")},a.onmessage=function(t){var r,_,p,g;JSON.parse(t.data),console.log(t.data);let o=(_=(r=t.data)==null?void 0:r.car)==null?void 0:_.battery_percentage;o!=null&&(l.value=o);let e=(g=(p=t.data)==null?void 0:p.car)==null?void 0:g.estimated_time_until_full;e!=null&&(d.value=e)},a.onerror=function(t){console.log("WebSocket Error: ",t)},a.onclose=function(t){console.log("WebSocket closed.")}}),C(()=>{a.close()}),(t,o)=>(s(),n("div",Q,[m(H,{class:"dashboard-item"}),m(z,{class:"dashboard-item",charge:l.value,hours:d.value},null,8,["charge","hours"]),m(K,{class:"dashboard-item"})]))}};export{Y as default};
