import{_ as D,r as c,o as f,a as n,c as s,t as v,F as w,b as y,d,p as S,e as $,n as k,f as C,g as m}from"./index-CCzqN0MI.js";const x=l=>(S("data-v-684cfe1b"),l=l(),$(),l),I=x(()=>d("h1",null,"Calendar Data",-1)),B={key:0},E={key:1,class:"error"},F={key:2},N={class:"calendar-item"},W={__name:"DashboardCalendar",setup(l){const h=c(null),o=c(!1),i=c(null),_={weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"};function r(a){return new Intl.DateTimeFormat("en-US",_).format(new Date(a))}async function e(){o.value=!0;try{const a=await fetch("http://127.0.0.1:8000/api/calendar/");if(!a.ok)throw new Error("Failed to fetch");const t=await a.json();h.value=t[0].google_response.items}catch(a){i.value=a.message}finally{o.value=!1}}return f(()=>{e()}),(a,t)=>(n(),s("div",null,[I,o.value?(n(),s("div",B,"Loading...")):i.value?(n(),s("div",E,v(i.value),1)):(n(),s("div",F,[(n(!0),s(w,null,y(h.value,u=>(n(),s("div",N,[d("h2",null,v(u.summary),1),d("div",null,v(r(u.start.dateTime)),1)]))),256))]))]))}},H=D(W,[["__scopeId","data-v-684cfe1b"]]),b=l=>(S("data-v-3738de08"),l=l(),$(),l),L=b(()=>d("h1",null,"Battery State",-1)),T={key:0},j={key:1,class:"error"},M={key:2},O={class:"calendar-item"},P=b(()=>d("div",null,"NOT CONNECTED",-1)),R={style:{"border-top":"1px solid #212121","margin-top":"8px","padding-top":"4px"}},U=b(()=>d("div",null,"For 100% charge",-1)),V={__name:"DashboardBattery",props:{charge:Number,hours:String},setup(l){const h=c(null),o=c(!1),i=c(null),_=l;async function r(){o.value=!0;try{const e=await fetch("http://127.0.0.1:8000/api/calendar/");if(!e.ok)throw new Error("Failed to fetch");const a=await e.json();h.value=a[0].google_response.items}catch(e){i.value=e.message}finally{o.value=!1}}return f(()=>{r()}),(e,a)=>(n(),s("div",null,[L,o.value?(n(),s("div",T,"Loading...")):i.value?(n(),s("div",j,v(i.value),1)):(n(),s("div",M,[d("div",O,[d("h2",null,v(_.charge)+"%",1),P,d("h2",R,v(_.hours),1),U])]))]))}},z=D(V,[["__scopeId","data-v-3738de08"]]),J=d("h1",null,"Charge Moments",-1),q={class:"charge-histogram"},A={class:"charge-histogram-charging-indicator"},G=["onClick"],K={__name:"DashboardHistogram",setup(l){const h=c(10),o=c(!0);function i(t,u){return u==h.value?"background:orange;":t==!1?"background:red;":"background:green;"}c([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);function _(t){h.value=t,a()}const r=c(null),e=c(null);async function a(){o.value=!0;try{const t=await fetch("http://127.0.0.1:8000/api/curve/?deadline="+h.value);if(!t.ok)throw new Error("Failed to fetch");const u=await t.json();e.value=u.best_options,r.value=u.scores.split(",").map(function(p){return parseInt(p,10)})}catch(t){t.value=t.message}finally{o.value=!1}}return f(()=>{a()}),(t,u)=>(n(),s("div",null,[J,d("div",q,[(n(!0),s(w,null,y(r.value,(p,g)=>(n(),s("div",{class:"price-bar",style:k({height:p+"%"})},null,4))),256))]),d("div",A,[(n(!0),s(w,null,y(e.value,(p,g)=>(n(),s("div",{class:"charge-bar",style:k(i(p,g)),onClick:X=>_(g)},null,12,G))),256))])]))}},Q={class:"dashboard-container"},Z={__name:"DashboardView",setup(l){function h(){var r=window.location.protocol==="https:"?"wss:":"ws:",e=window.location.host;(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")&&(e="localhost:8000");var a="/ws/car/",t=r+"//"+e+a;return new WebSocket(t)}let o=h();const i=c(0),_=c(0);return f(()=>{o.onopen=function(){console.log("WebSocket connected.")},o.onmessage=function(r){var u,p;const e=JSON.parse(r.data);let a=(u=e==null?void 0:e.car)==null?void 0:u.battery_percentage;a!=null&&(i.value=a);let t=(p=e==null?void 0:e.car)==null?void 0:p.estimated_time_until_full;t!=null&&(_.value=t)},o.onerror=function(r){console.log("WebSocket Error: ",r)},o.onclose=function(r){console.log("WebSocket closed.")}}),C(()=>{o.close()}),(r,e)=>(n(),s("div",Q,[m(H,{class:"dashboard-item"}),m(z,{class:"dashboard-item",charge:i.value,hours:_.value},null,8,["charge","hours"]),m(K,{class:"dashboard-item"})]))}};export{Z as default};
