import{_ as k,r as u,o as f,a as o,c as n,t as p,F as m,b,d as i,p as D,e as S,n as y,f as $,g}from"./index-DviWFEWI.js";const C=c=>(D("data-v-684cfe1b"),c=c(),S(),c),x=C(()=>i("h1",null,"Calendar Data",-1)),I={key:0},B={key:1,class:"error"},E={key:2},F={class:"calendar-item"},N={__name:"DashboardCalendar",setup(c){const h=u(null),a=u(!1),l=u(null),d={weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"};function r(e){return new Intl.DateTimeFormat("en-US",d).format(new Date(e))}async function t(){a.value=!0;try{const e=await fetch("http://127.0.0.1:8000/api/calendar/");if(!e.ok)throw new Error("Failed to fetch");const s=await e.json();h.value=s[0].google_response.items}catch(e){l.value=e.message}finally{a.value=!1}}return f(()=>{t()}),(e,s)=>(o(),n("div",null,[x,a.value?(o(),n("div",I,"Loading...")):l.value?(o(),n("div",B,p(l.value),1)):(o(),n("div",E,[(o(!0),n(m,null,b(h.value,_=>(o(),n("div",F,[i("h2",null,p(_.summary),1),i("div",null,p(r(_.start.dateTime)),1)]))),256))]))]))}},W=k(N,[["__scopeId","data-v-684cfe1b"]]),w=c=>(D("data-v-9eb460d5"),c=c(),S(),c),H=w(()=>i("h1",null,"Battery State",-1)),L={key:0},T={key:1,class:"error"},j={key:2},O={class:"calendar-item"},P=w(()=>i("div",null,"NOT CONNECTED",-1)),R={style:{"border-top":"1px solid #212121","margin-top":"8px","padding-top":"4px"}},U=w(()=>i("div",null,"For 80% charge",-1)),V={__name:"DashboardBattery",props:{charge:Number,hours:String},setup(c){const h=u(null),a=u(!1),l=u(null),d=c;async function r(){a.value=!0;try{const t=await fetch("http://127.0.0.1:8000/api/calendar/");if(!t.ok)throw new Error("Failed to fetch");const e=await t.json();h.value=e[0].google_response.items}catch(t){l.value=t.message}finally{a.value=!1}}return f(()=>{r()}),(t,e)=>(o(),n("div",null,[H,a.value?(o(),n("div",L,"Loading...")):l.value?(o(),n("div",T,p(l.value),1)):(o(),n("div",j,[i("div",O,[i("h2",null,p(d.charge),1),P,i("h2",R,p(d.hours),1),U])]))]))}},M=k(V,[["__scopeId","data-v-9eb460d5"]]),z=i("h1",null,"Charge Moments",-1),J={class:"charge-histogram"},q={class:"charge-histogram-charging-indicator"},A=["onClick"],G={__name:"DashboardHistogram",setup(c){const h=u(10),a=u(!0);function l(e,s){return e==s?"background:red;":e>s?"background: #212121;":"background: #green;"}const d=u([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);function r(e){h.value=e}async function t(){a.value=!0;try{const e=await fetch("http://127.0.0.1:8000/api/curve/");if(!e.ok)throw new Error("Failed to fetch");const s=await e.json();d.value=s}catch(e){error.value=e.message}finally{a.value=!1}}return f(()=>{t()}),(e,s)=>(o(),n("div",null,[z,i("div",J,[(o(!0),n(m,null,b(d.value,(_,v)=>(o(),n("div",{class:"price-bar",style:y({height:_+"%"})},null,4))),256))]),i("div",q,[(o(!0),n(m,null,b(d.value,(_,v)=>(o(),n("div",{class:"charge-bar",style:y(l(v,h.value)),onClick:Q=>r(v)},null,12,A))),256))])]))}},K={class:"dashboard-container"},Y={__name:"DashboardView",setup(c){function h(){var r=window.location.protocol==="https:"?"wss:":"ws:",t=window.location.host;(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")&&(t="localhost:8000");var e="/ws/car/",s=r+"//"+t+e;return new WebSocket(s)}let a=h();const l=u(0),d=u(0);return f(()=>{a.onopen=function(){console.log("WebSocket connected.")},a.onmessage=function(r){var _,v;const t=JSON.parse(r.data);let e=(_=t==null?void 0:t.car)==null?void 0:_.battery_percentage;e!=null&&(l.value=e);let s=(v=t==null?void 0:t.car)==null?void 0:v.estimated_time_until_full;s!=null&&(d.value=s)},a.onerror=function(r){console.log("WebSocket Error: ",r)},a.onclose=function(r){console.log("WebSocket closed.")}}),$(()=>{a.close()}),(r,t)=>(o(),n("div",K,[g(W,{class:"dashboard-item"}),g(M,{class:"dashboard-item",charge:l.value,hours:d.value},null,8,["charge","hours"]),g(G,{class:"dashboard-item"})]))}};export{Y as default};
