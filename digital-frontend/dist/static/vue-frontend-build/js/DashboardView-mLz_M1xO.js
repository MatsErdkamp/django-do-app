import{_ as $,r as h,o as v,a as s,c as n,t as p,F as w,b,d as i,p as S,e as C,n as k,f as x,g as m,u as D}from"./index-pV4YBm3l.js";const I=c=>(S("data-v-684cfe1b"),c=c(),C(),c),N=I(()=>i("h1",null,"Calendar Data",-1)),B={key:0},E={key:1,class:"error"},F={key:2},W={class:"calendar-item"},H={__name:"DashboardCalendar",setup(c){const u=h(null),a=h(!1),l=h(null),d={weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"};function t(e){return new Intl.DateTimeFormat("en-US",d).format(new Date(e))}async function o(){a.value=!0;try{const e=await fetch("http://127.0.0.1:8000/api/calendar/");if(!e.ok)throw new Error("Failed to fetch");const r=await e.json();u.value=r[0].google_response.items}catch(e){l.value=e.message}finally{a.value=!1}}return v(()=>{o()}),(e,r)=>(s(),n("div",null,[N,a.value?(s(),n("div",B,"Loading...")):l.value?(s(),n("div",E,p(l.value),1)):(s(),n("div",F,[(s(!0),n(w,null,b(u.value,_=>(s(),n("div",W,[i("h2",null,p(_.summary),1),i("div",null,p(t(_.start.dateTime)),1)]))),256))]))]))}},L=$(H,[["__scopeId","data-v-684cfe1b"]]),y=c=>(S("data-v-27530213"),c=c(),C(),c),T=y(()=>i("h1",null,"Battery State",-1)),j={key:0},O={key:1,class:"error"},P={key:2},R={class:"calendar-item"},U=y(()=>i("div",null,"NOT CONNECTED",-1)),V={style:{"border-top":"1px solid #212121","margin-top":"8px","padding-top":"4px"}},M=y(()=>i("div",null,"For 80% charge",-1)),z={__name:"DashboardBattery",props:{charge:Number,hours:Number},setup(c){const u=h(null),a=h(!1),l=h(null),d=c;async function t(){a.value=!0;try{const o=await fetch("http://127.0.0.1:8000/api/calendar/");if(!o.ok)throw new Error("Failed to fetch");const e=await o.json();u.value=e[0].google_response.items}catch(o){l.value=o.message}finally{a.value=!1}}return v(()=>{t()}),(o,e)=>(s(),n("div",null,[T,a.value?(s(),n("div",j,"Loading...")):l.value?(s(),n("div",O,p(l.value),1)):(s(),n("div",P,[i("div",R,[i("h2",null,p(d.charge),1),U,i("h2",V,p(d.hours),1),M])]))]))}},J=$(z,[["__scopeId","data-v-27530213"]]),q=i("h1",null,"Charge Moments",-1),A={class:"charge-histogram"},G={class:"charge-histogram-charging-indicator"},K=["onClick"],Q={__name:"DashboardHistogram",setup(c){const u=h(10),a=h(!0);function l(e,r){return e==r?"background:red;":e>r?"background: #212121;":"background: #green;"}const d=h([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);function t(e){u.value=e}async function o(){a.value=!0;try{const e=await fetch("http://127.0.0.1:8000/api/curve/");if(!e.ok)throw new Error("Failed to fetch");const r=await e.json();d.value=r}catch(e){error.value=e.message}finally{a.value=!1}}return v(()=>{o()}),(e,r)=>(s(),n("div",null,[q,i("div",A,[(s(!0),n(w,null,b(d.value,(_,f)=>(s(),n("div",{class:"price-bar",style:k({height:_+"%"})},null,4))),256))]),i("div",G,[(s(!0),n(w,null,b(d.value,(_,f)=>(s(),n("div",{class:"charge-bar",style:k(l(f,u.value)),onClick:g=>t(f)},null,12,K))),256))])]))}},X={class:"dashboard-container"},Z={__name:"DashboardView",setup(c){function u(){var t=window.location.protocol==="https:"?"wss:":"ws:",o=window.location.host;(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")&&(o="localhost:8000");var e="/ws/car/",r=t+"//"+o+e;return new WebSocket(r)}let a=u();const l=ref(0),d=ref(0);return v(()=>{a.onopen=function(){console.log("WebSocket connected.")},a.onmessage=function(t){var r,_,f,g;JSON.parse(t.data),console.log(t.data);let o=(_=(r=t.data)==null?void 0:r.car)==null?void 0:_.battery_percentage;o!=null&&(l.value=o);let e=(g=(f=t.data)==null?void 0:f.car)==null?void 0:g.estimated_time_until_full;e!=null&&(d.value=e)},a.onerror=function(t){console.log("WebSocket Error: ",t)},a.onclose=function(t){console.log("WebSocket closed.")}}),x(()=>{a.close()}),(t,o)=>(s(),n("div",X,[m(L,{class:"dashboard-item"}),m(J,{class:"dashboard-item",charge:D(l),hours:D(d)},null,8,["charge","hours"]),m(Q,{class:"dashboard-item"})]))}};export{Z as default};
